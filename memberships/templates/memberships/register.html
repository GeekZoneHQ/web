{% extends "base.html" %}
{% load widget_tweaks %}

{% block content %}
<section class="">
  <div>
    <h2 class="m-main-section header">Member Registration</h2>

    {% if recaptcha_enabled %}
    <script>
    /*Execute recaptchaV3 function*/
    grecaptcha.ready(function() {
      grecaptcha.execute("{{ recaptcha_site_key }}", {action: "/register/"}).then(function(token) {
        document.getElementById('recaptchaV3-response').value = token;
      });
    });
    </script>
    {% endif %}

    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
        <li {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}

    <p class="m-main-section">
      Will you complete this quest to achieve geeky greatness?
      Epic adventurers use a <a class="link" href="http://example.com">password manager</a>!
    </p>

    <form class="mb-1" action="{% url 'register' %}" method="POST">
      {% csrf_token %}

      {% for field in form %}
      <div class="ml-4 text-sm">
        {{ field.errors }}

        <div class="mb-2 flex items-center">
          {{ field | add_label_class:"mr-2"}}
          {{ field | add_class:"border-input" | add_required_class:".input-required" | add_error_class:"border-red-500" }}
          {% if field.field.required %}
          <span class="ml-1 text-red-500">*</span>
          {% endif %}
          {% if field.help_text %}
          <div class="help-icon w-full relative ml-1 flex items-center cursor-pointer" onclick="toggleHelpText('{{ field.name }}')">
            <div>&#9432;</div>
            <div class="{{ field.name }}-help-text absolute left-4 flex items-center z-10 invisible">
              <div class="relative -right-px text-gray-600">&#9668;</div>
              <div class="relative -left-px py-2 px-3 rounded bg-gray-600 text-gray-200 text-xs">{{ field.help_text | safe }}</div>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
      {% endfor %}

      <p class="m-main-section">
        In the future you would put your payment here, and how much you wanted to
        donate per membership term.
      </p>

      {% if recaptcha_enabled %}
      <input type="hidden" id="recaptcha-v3-response" name="recaptcha-v3-response"/>
      {% endif %}

      <input class="m-main-section btn" type="submit" value="Register"/>
    </form>

    <p class="m-main-section">Already a member? <a class="link" href="{% url 'memberships_login' %}">Login!</a></p>
  </div>
</section>
{% endblock %}
